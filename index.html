<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jet A1 Fuel Uplift Calculator</title>
    <style>
        /* Style the result text to be red and bold */
        #upliftFuelResult {
            color: red;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <h1>Jet A1 Fuel Uplift Calculator</h1>
    
    <form id="fuelForm">
        <label for="remainingFuel">Enter remaining fuel in pounds (lbs):</label>
        <input type="number" id="remainingFuel" name="remainingFuel" step="any" required><br><br>

        <label for="requiredFuel">Enter total required fuel in pounds (lbs):</label>
        <input type="number" id="requiredFuel" name="requiredFuel" step="any" required><br><br>

        <label for="density">Enter fuel density in kg/L (if known):</label>
        <input type="number" id="density" name="density" step="any"><br><br>

        <label for="temperature">Enter fuel temperature in °C (optional):</label>
        <input type="number" id="temperature" name="temperature" step="any" oninput="computeDensityFromTemperature()"><br><br>

        <label for="convertTo">Convert required uplift fuel to:</label>
        <select id="convertTo" name="convertTo">
            <option value="liters">Liters</option>
            <option value="gallons">US Gallons</option>
        </select><br><br>

        <button type="button" onclick="calculateFuel()">Calculate</button>
    </form>

    <h2>Result:</h2>
    <p id="upliftFuelResult">Required uplift fuel (lbs/liters): -</p>

    <h3>Uplift Actual Entry</h3>
    <form id="upliftForm">
        <label for="upliftActual">Enter uplift actual in liters or US gallons:</label>
        <input type="number" id="upliftActual" name="upliftActual" step="any" required>
        <select id="upliftUnit" name="upliftUnit">
            <option value="liters">Liters</option>
            <option value="gallons">US Gallons</option>
        </select><br><br>

        <button type="button" onclick="calculateTotalActual()">Compute Total Actual in Pounds</button>
    </form>

    <h3>Total Actual Fuel in Pounds</h3>
    <p id="totalActualFuel">Total actual fuel (lbs): -</p>

    <script>
        let upliftFuelPounds = 0; // Variable to store uplift fuel in pounds

        function computeDensityFromTemperature() {
            const temperatureInput = document.getElementById("temperature");
            const densityInput = document.getElementById("density");

            const temperature = parseFloat(temperatureInput.value);

            // Check if temperature is provided and calculate density
            if (!isNaN(temperature)) {
                densityInput.disabled = true;
                const computedDensity = 0.8 - (0.003 * (temperature - 15)); // Formula for density based on temperature
                densityInput.value = computedDensity.toFixed(4); // Update density field with calculated density
            } else {
                densityInput.disabled = false;
                densityInput.value = ''; // Clear the density value
            }
        }

        function calculateFuel() {
            // Get user inputs
            const remainingFuel = parseFloat(document.getElementById("remainingFuel").value);
            const requiredFuel = parseFloat(document.getElementById("requiredFuel").value);
            let density = parseFloat(document.getElementById("density").value);
            const temperature = parseFloat(document.getElementById("temperature").value);

            // If temperature is entered, calculate density
            if (!isNaN(temperature)) {
                density = 0.8 - (0.003 * (temperature - 15));
            }

            // Check if density is valid
            if (isNaN(density) || density <= 0) {
                alert("Please enter a valid density or temperature.");
                return;
            }

            const convertTo = document.getElementById("convertTo").value;

            // Calculate the required uplift fuel in pounds (lbs)
            upliftFuelPounds = requiredFuel - remainingFuel;

            // Check if uplift fuel is positive
            if (upliftFuelPounds < 0) {
                alert("Remaining fuel cannot exceed total required fuel.");
                return;
            }

            // Convert uplift fuel to chosen units
            let upliftFuelConverted;
            if (convertTo === "liters") {
                upliftFuelConverted = upliftFuelPounds / 2.20462 / density; // Convert lbs to kg, then to liters
            } else if (convertTo === "gallons") {
                const liters = upliftFuelPounds / 2.20462 / density;
                upliftFuelConverted = liters * 0.264172; // Convert liters to US gallons
            }

            // Display the result
            document.getElementById("upliftFuelResult").innerText = `Required uplift fuel: ${Math.round(upliftFuelPounds)} lbs / ${Math.round(upliftFuelConverted)} ${convertTo}`;
        }

        function calculateTotalActual() {
            // Get uplift actual and the unit
            const upliftActual = parseFloat(document.getElementById("upliftActual").value);
            const upliftUnit = document.getElementById("upliftUnit").value;

            let upliftActualPounds = 0;
            let density = parseFloat(document.getElementById("density").value);
            const temperature = parseFloat(document.getElementById("temperature").value);

            // If temperature is entered, calculate density
            if (!isNaN(temperature)) {
                density = 0.8 - (0.003 * (temperature - 15));
            }

            // Check if density is valid
            if (isNaN(density) || density <= 0) {
                alert("Please enter a valid density or temperature.");
                return;
            }

            // Convert uplift actual to pounds if it's in liters or gallons
            if (upliftUnit === "liters") {
                upliftActualPounds = upliftActual * density * 2.20462; // Convert liters to kg, then to lbs
            } else if (upliftUnit === "gallons") {
                const liters = upliftActual / 0.264172; // Convert gallons to liters
                upliftActualPounds = liters * density * 2.20462; // Convert liters to kg, then to lbs
            }

            // Get remaining fuel and calculate the total actual fuel in pounds
            const remainingFuel = parseFloat(document.getElementById("remainingFuel").value);
            const totalActualFuel = remainingFuel + upliftActualPounds;

            // Display the total actual fuel in pounds
            document.getElementById("totalActualFuel").innerText = `Total actual fuel: ${Math.round(totalActualFuel)} lbs`;
        }
    </script>
</body>
</html>
